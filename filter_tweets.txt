--[mthanky@md01 ~]$ hadoop fs -ls /user/marekdragan/New_Tweets/ --957 files
--[mthanky@md01 ~]$ hadoop fs -cp /user/marekdragan/New_Tweets/ /user/mthanky/tweets
--[mthanky@md01 ~]$ hadoop fs -ls /user/mthanky/tweets


--Pig code to filter down tweets to those I want to export

REGISTER hdfs:///jar/elephant-bird/json-simple-1.1.1.jar;
REGISTER hdfs:///jar/elephant-bird/elephant-bird-core-4.6-SNAPSHOT.jar;
REGISTER hdfs:///jar/elephant-bird/elephant-bird-pig-4.6-SNAPSHOT.jar;
REGISTER hdfs:///jar/elephant-bird/elephant-bird-hadoop-compat-4.6-SNAPSHOT.jar;
REGISTER hdfs:///jar/tutorial.jar;

A = load ' /user/mthanky/tweets/ ' USING com.twitter.elephantbird.pig.load.JsonLoader('-
nestedLoad') as tweets;

C = FOREACH A GENERATE
(CHARARRAY)tweets#'id' as id,
(CHARARRAY)tweets#'lang' AS lang,
(CHARARRAY)tweets#'created_at' AS created_at,
(CHARARRAY)tweets#'text' AS text,
tweets#'user' as user_info,
tweets#'retweeted_status' as retweet_info,
(INT)tweets#'favorite_count' as fav_count --MT added
;

D = FOREACH C GENERATE
id,
lang,
created_at,
fav_count, --MT added
(CHARARRAY)user_info#'screen_name' as screen_name,
(CHARARRAY)user_info#'name' as name,
(CHARARRAY)user_info#'location' as location,
(CHARARRAY)user_info#'verified' as verification, --MT added
(CHARARRAY)user_info#'
(INT)retweet_info#'retweet_count' as retweet_count,
REPLACE(text, '\n', ' ') AS text
;

E = FILTER D BY (text matches '(?i).*obama.*'); 

F = limit E 20;
dump F;



